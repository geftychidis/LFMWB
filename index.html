<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LFMWB Evaluation Mission — Interactive Map & Plan (27 Oct – 7 Nov 2025)</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css"/>

<style>
  :root { 
    --green:#2E8B57; 
    --green2:#228B22; /* Σωστή ορισμός για χρήση στο hover */
    --bg1:#f5f7fa; 
    --bg2:#c3cfe2; 
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%)}
  .header{background:linear-gradient(135deg,var(--green) 0%,var(--green2) 100%);color:#fff;padding:20px;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,1)}
  .header h1{margin:0;font-size:28px}
  .header p{margin:6px 0 0;opacity:.95}
  /* ----- LAYOUT ----- */
  .main{display:flex;gap:20px;padding:20px;height:calc(100vh - 150px)}
  .panel{background:#fff;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.18)}
  .map-wrap{position:relative;flex:2;overflow:hidden;display:flex;min-height:520px;height:100%}
  #map{flex:1;min-height:520px;width:100%;background:#eef3f7}
  .sidebar{flex:1;display:flex;flex-direction:column;gap:16px;overflow-y:auto; /* Χρήση overflow-y για καλύτερο έλεγχο */ max-height:calc(100vh - 190px);padding:16px}
  /* ----- UI ----- */
  .card{padding:16px}
  .card h3{margin:0 0 10px;color:var(--green);border-bottom:2px solid var(--green);padding-bottom:8px}
  .loc{background:#f8f9fa;border-left:4px solid var(--green);border-radius:10px;padding:12px;margin-bottom:12px;cursor:pointer;transition:.25s}
  .loc:hover{transform:translateX(4px);box-shadow:0 4px 12px rgba(0,0,0,.08)}
  .loc.active{background:#e8f5e8;border-left-color:var(--green2)}
  .loc .t{font-weight:bold;margin-bottom:4px}
  .loc .d{display:inline-block;font-size:12px;background:var(--green);color:#fff;padding:3px 8px;border-radius:4px;margin:4px 0 8px}
  .loc .org{font-size:12px;color:#444;line-height:1.4}
  .controls{position:absolute;top:10px;right:10px;z-index:999;background:#fff;padding:8px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.12)}
  .controls button{background:var(--green);color:#fff;border:0;padding:7px 10px;border-radius:4px;margin:2px;font-size:12px;cursor:pointer}
  .controls button:hover{background:var(--green2)}
  .stats{background:#e8f5e8;border-radius:10px;padding:14px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .stat{text-align:center;background:#fff;padding:10px;border-radius:8px}
  .stat .n{font-weight:bold;font-size:20px;color:var(--green)}
  .stat .l{font-size:11px;color:#666}
  .hotels, .contacts{font-size:13px;line-height:1.45}
  .hotels b, .contacts b{color:#333}
  .small{font-size:12px;color:#555}
  .popup .title{font-weight:bold;color:var(--green);margin-bottom:4px}
  .popup .dates{display:inline-block;background:var(--green);color:#fff;font-size:11px;padding:3px 8px;border-radius:4px;margin:4px 0 8px}
  .popup ul{margin:6px 0 0 18px;padding:0}
  .popup li{margin:3px 0}
  @media (max-width: 900px){
    .main{flex-direction:column;height:auto}
    .map-wrap{height:420px;min-height:420px}
    #map{min-height:420px}
    .sidebar{max-height:none}
  }
</style>
</head>
<body>
  <div class="header">
    <h1>🗺️ LFMWB External Evaluation Mission</h1>
    <p>Interactive Travel Route, Meetings & Logistics • 27 Oct – 7 Nov 2025 • Western Balkans</p>
  </div>

  <div class="main">
    <div class="panel map-wrap">
      <div id="map"></div>
      <div class="controls">
        <button onclick="showRoute()">Show Route</button>
        <button onclick="fitAll()">Fit View</button>
        <button onclick="toggleAnim()" id="animBtn">Animate</button>
      </div>
    </div>

    <div class="panel sidebar">
      <div class="card">
        <h3>📍 Mission Locations</h3>

        <div class="loc" data-i="0" tabindex="0" role="button" aria-label="Skopje, North Macedonia: Oct 27–30, 2025">
          <div class="t">🏛️ Skopje, North Macedonia 🇲🇰</div>
          <div class="d">Oct 27–30, 2025</div>
          <div class="org small">
            28 Oct: Farmahem (REA) — C. Nikolovski; M. Sterjovska; K. Atanasovska; J. P. Andonovska; S. Shosholceva.<br/>
            28 Oct: MAFWE — Mr. Jordan Zdravkovski (CFP) [interp: Yes].<br/>
            28 Oct: RFMC — Prof. Nikola Nikolov; Mr. Jakob Kiprovski; Mr. Velian Jagev.<br/>
            29 Oct (AM): Public Enterprise “Pastures” — Ms. Tatjana Milcevska [interp: Yes].<br/>
            29 Oct (11:00–12:00): Meeting with Bojan Mihajlovski (CPS).
          </div>
        </div>

        <div class="loc" data-i="1" tabindex="0" role="button" aria-label="Radoviš, North Macedonia: Oct 29, 2025 site visit">
          <div class="t">🧭 Radoviš, North Macedonia 🇲🇰</div>
          <div class="d">Oct 29, 2025 (site visit)</div>
          <div class="org small">CBC: LAG Plackovica — Mr. Stole Georgiev. Same-day return to Skopje.</div>
        </div>

        <div class="loc" data-i="2" tabindex="0" role="button" aria-label="Prishtina, Kosovo: Oct 30, 2025 same-day">
          <div class="t">💼 Prishtina, Kosovo 🇽🇰</div>
          <div class="d">Oct 30, 2025 (same-day)</div>
          <div class="org small">
            MAFRD — Mr. Tahir Ahmeti (CFP) [interp: Yes].<br/>
            Kosovo Forestry Agency (Dir. for Forest Management) — Mr. Menderes Ibra.<br/>
            14:00–15:00 CPS meeting — Ms. Arlinda Gashi (CPS).<br/>
            15:00–17:00 CBC: Peer Educators Network. Return to Skopje.
          </div>
        </div>

        <div class="loc" data-i="3" tabindex="0" role="button" aria-label="Niš, Serbia: Oct 31, 2025 morning">
          <div class="t">🌿 Niš, Serbia 🇷🇸</div>
          <div class="d">Oct 31, 2025 (AM)</div>
          <div class="org small">CBC: Biological Society “Dr. Sava Petrović” (meeting). PM transfer to Belgrade.</div>
        </div>

        <div class="loc" data-i="4" tabindex="0" role="button" aria-label="Belgrade, Serbia: Oct 31 – Nov 3, 2025">
          <div class="t">🏰 Belgrade, Serbia 🇷🇸</div>
          <div class="d">Oct 31 – Nov 3, 2025</div>
          <div class="org small">
            1–2 Nov: Weekend (summary/free).<br/>
            3 Nov (09:00–10:30): Directorate of Forests — Mr. Vladimir Nikolić (CFP).<br/>
            3 Nov (11:00–12:00): Faculty of Forestry (Univ. of Belgrade) — Prof. Slobodan Milanović.<br/>
            3 Nov (14:00–15:30): Helvetas Serbia — Mr. Nenad Celarevic (backstopper).<br/>
            3 Nov (16:00–17:00): Ms. Ana Stefanović (CPS).
          </div>
        </div>

        <div class="loc" data-i="5" tabindex="0" role="button" aria-label="Srbac, Republika Srpska (BiH): Nov 4, 2025">
          <div class="t">🌲 Srbac, Republika Srpska (BiH) 🇧🇦</div>
          <div class="d">Nov 4, 2025</div>
          <div class="org small">
            CBC: Association “C.E.Z.A.R.” (13:30–15:30).<br/>
            16:30–17:30: Meeting with Mr. Miroslav Rakita (CPS). Transfer to Banja Luka.
          </div>
        </div>

        <div class="loc" data-i="6" tabindex="0" role="button" aria-label="Banja Luka, Republika Srpska (BiH): Nov 5, 2025">
          <div class="t">🌳 Banja Luka, Republika Srpska (BiH) 🇧🇦</div>
          <div class="d">Nov 5, 2025</div>
          <div class="org small">
            09:00–10:30: Ministry of Agriculture, Forestry & Water Management — Mr. Slavko Stupar (CFP) [interp: Yes].<br/>
            10:30–11:30: Public Enterprise “Šume Republike Srpske” — Mr. Saša Ljubojević.<br/>
            PM transfer to Sarajevo.
          </div>
        </div>

        <div class="loc" data-i="7" tabindex="0" role="button" aria-label="Sarajevo, Federation of BiH: Nov 5 – Nov 7, 2025">
          <div class="t">🏛️ Sarajevo, Federation of BiH 🇧🇦</div>
          <div class="d">Nov 5 (late) – Nov 7, 2025</div>
          <div class="org small">
            6 Nov (09:00–10:30): Federal MoA, Water Mgmt & Forestry — Mr. Emir Caushević (CFP) [interp: Yes].<br/>
            6 Nov (10:30–11:30): Federal Civil Protection Agency — Mr. Ramo Dautbašić [interp: Yes].<br/>
            6 Nov (11:30–13:00): FEA — Forestry & Environmental Action (CBC, BIH/SRB).<br/>
            6 Nov (14:30–16:00): Online debrief (Evaluators, SDC, Embassy of Switzerland (MK), Farmahem).<br/>
            7 Nov: Departures (Switzerland & Greece).
          </div>
        </div>

        <div class="stats">
          <h4 style="margin:0;color:var(--green)">Mission Statistics</h4>
          <div class="grid" style="margin-top:10px">
            <div class="stat"><div class="n">12</div><div class="l">Days</div></div>
            <div class="stat"><div class="n">8</div><div class="l">Cities</div></div>
            <div class="stat"><div class="n">4</div><div class="l">Countries</div></div>
            <div class="stat"><div class="n">25+</div><div class="l">Organizations</div></div>
          </div>
        </div>
      </div>

      <div class="card hotels">
        <h3>🏨 Hotels (suggested)</h3>
        <b>Skopje (27–30 Oct)</b><br/>
        • Bushi Resort & Spa — city center; good access to REA/RFMC/MAFWE.<br/>
        • Ibis Skopje City Center — business option, walkable.<br/><br/>

        <b>Belgrade (31 Oct–3 Nov)</b><br/>
        • Mark Hotel — central; suitable for meetings nearby.<br/>
        • Saint Ten / Courtyard by Marriott — business standard.<br/><br/>

        <b>Banja Luka (4 Nov)</b><br/>
        • Courtyard by Marriott — business option; reliable late check-in.<br/><br/>

        <b>Sarajevo (5–7 Nov)</b><br/>
        • Courtyard by Marriott — Intl. standard; walkable to Federal Ministry/FEA. (Recommended)<br/>
        • Aparthotel Centar — lower cost; apartment style.
        <div class="small" style="margin-top:8px">
          Overnights: Skopje (27–30 Oct), Belgrade (31 Oct–3 Nov), Banja Luka (4 Nov), Sarajevo (5–6 Nov). Depart 7 Nov.
        </div>
      </div>

      <div class="card contacts">
        <h3>🚗 Local Contacts / Drivers</h3>
        <b>Skopje (MKD):</b> Ida Blaževska — <a href="mailto:ida.blazevska@gmail.com">ida.blazevska@gmail.com</a> — +389 71 277 193<br/>
        <b>Prishtina (KS):</b> Edmond Gjonbalaj — <a href="mailto:edmondgjonbalaj@gmail.com">edmondgjonbalaj@gmail.com</a> — +383 44 384 841<br/>
        <b>Republika Srpska (BiH):</b> Dejan Milinović — <a href="mailto:dejan.milinovic@flf.unibl.org">dejan.milinovic@flf.unibl.org</a> — +387 65 870 046<br/>
        <b>Sarajevo (FBiH):</b> Benjamin Sarhatlić — <a href="mailto:info@agencijaprevod.ba">info@agencijaprevod.ba</a> — +387 61 393 777
      </div>

      <div class="card">
        <h3>🧪 Evaluation Focus</h3>
        <div class="small">
          Relevance • Effectiveness • Efficiency • Prospective Impact & Sustainability • Gender/Youth/Inclusion embedded across tools.<br/>
          Triangulation: document review, stakeholder mapping, semi-structured interviews, site visits, survey to networks.
        </div>
      </div>

      <div class="card">
        <h3>📑 Questionnaire Forms</h3>
        <div class="small">
          Form 1 — Policy Integration (CFP/Ministries) • Form 2 — Institutional Ownership (Networks/RFMC/REA)<br/>
          Form 3 — Community Impact (CBC grantees) • Form 4 — Capacity Building • Form 5 — Regional Coordination
        </div>
      </div>
    </div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script>
  // -------- Locations --------
  const locations = [
    { name:"Skopje, North Macedonia", flag:"🇲🇰", icon:"🏛️", coords:[41.9973,21.4280],
      dates:"Oct 27–30, 2025",
      details:[
        "28 Oct: Farmahem (REA) — C. Nikolovski; M. Sterjovska; K. Atanasovska; J. P. Andonovska; S. Shosholceva",
        "28 Oct: MAFWE — Mr. Jordan Zdravkovski (CFP) [interp: Yes]",
        "28 Oct: RFMC — Prof. Nikola Nikolov; Mr. Jakob Kiprovski; Mr. Velian Jagev",
        "29 Oct (AM, Skopje): Public Enterprise “Pastures” — Ms. Tatjana Milcevska [interp: Yes]",
        "29 Oct (11:00–12:00): Meeting with Bojan Mihajlovski (CPS)"
      ]},
    { name:"Radoviš, North Macedonia", flag:"🇲🇰", icon:"🧭", coords:[41.6383,22.4647],
      dates:"Oct 29, 2025",
      details:["CBC site visit: LAG Plackovica — Mr. Stole Georgiev","Same-day return to Skopje"]},
    { name:"Prishtina, Kosovo", flag:"🇽🇰", icon:"💼", coords:[42.6629,21.1655],
      dates:"Oct 30, 2025 (same-day)",
      details:[
        "MAFRD — Mr. Tahir Ahmeti (CFP) [interp: Yes]",
        "Kosovo Forestry Agency — Directorate for Forest Management — Mr. Menderes Ibra",
        "14:00–15:00: Meeting with Ms. Arlinda Gashi (CPS)",
        "15:00–17:00: CBC: Peer Educators Network",
        "Return to Skopje"
      ]},
    { name:"Niš, Serbia", flag:"🇷🇸", icon:"🌿", coords:[43.3209,21.8958],
      dates:"Oct 31, 2025 (AM)",
      details:["CBC: Biological Society “Dr. Sava Petrović” (meeting)","PM transfer to Belgrade"]},
    { name:"Belgrade, Serbia", flag:"🇷🇸", icon:"🏰", coords:[44.7866,20.4489],
      dates:"Oct 31 – Nov 3, 2025",
      details:[
        "1–2 Nov: Weekend (summary/free)",
        "3 Nov (09:00–10:30): Directorate of Forests — Mr. Vladimir Nikolić (CFP)",
        "3 Nov (11:00–12:00): Faculty of Forestry — Prof. Slobodan Milanović",
        "3 Nov (14:00–15:30): Helvetas Serbia — Mr. Nenad Celarevic",
        "3 Nov (16:00–17:00): Ms. Ana Stefanović (CPS)"
      ]},
    { name:"Srbac, Republika Srpska (BiH)", flag:"🇧🇦", icon:"🌲", coords:[45.0967,17.5253],
      dates:"Nov 4, 2025",
      details:[
        "CBC: Association “C.E.Z.A.R.” (13:30–15:30)",
        "16:30–17:30: Meeting with Mr. Miroslav Rakita (CPS)",
        "Trip to Banja Luka"
      ]},
    { name:"Banja Luka, Republika Srpska (BiH)", flag:"🇧🇦", icon:"🌳", coords:[44.7722,17.1910],
      dates:"Nov 5, 2025",
      details:[
        "09:00–10:30: RS Ministry of Agriculture, Forestry & Water Mgmt — Mr. Slavko Stupar (CFP) [interp: Yes]",
        "10:30–11:30: Public Enterprise “Šume Republike Srpske” — Mr. Saša Ljubojević",
        "PM transfer to Sarajevo"
      ]},
    { name:"Sarajevo, Federation of BiH", flag:"🇧🇦", icon:"🏛️", coords:[43.8563,18.4131],
      dates:"Nov 5 (late) – Nov 7, 2025",
      details:[
        "6 Nov (09:00–10:30): Federal MoA, Water Mgmt & Forestry — Mr. Emir Caushević (CFP) [interp: Yes]",
        "6 Nov (10:30–11:30): Federal Civil Protection Agency — Mr. Ramo Dautbašić [interp: Yes]",
        "6 Nov (11:30–13:00): FEA — Forestry & Environmental Action (CBC, BIH/SRB)",
        "6 Nov (14:30–16:00): Online debrief — Evaluators; SDC; Embassy of Switzerland (MK); Farmahem",
        "7 Nov: Departures (Switzerland & Greece)"
      ]}
  ];

  // --- Map Init ---
  const map = L.map('map', { zoomControl: true }).setView([43.4, 20.3], 6);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
    { attribution:'© OpenStreetMap contributors', crossOrigin:true }).addTo(map);

  // Helper for custom icons
  function iconBadge(emoji, bg='var(--green)') { // Χρήση CSS μεταβλητής για το χρώμα
    return L.divIcon({
      html:`<div style="background:${bg};width:40px;height:40px;border-radius:50%;border:3px solid #fff;display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 3px 10px rgba(0,0,0,.3)">${emoji}</div>`,
      className:'x', iconSize:[40,40], iconAnchor:[20,20], popupAnchor:[0,-18]
    });
  }

  const markers=[]; let route=null, animTimer=null, animOn=false;

  function popupHtml(loc){
    const li = loc.details.map(x=>`<li>${x}</li>`).join('');
    return `<div class="popup"><div class="title">${loc.icon} ${loc.name} ${loc.flag}</div>
            <div class="dates">${loc.dates}</div><ul>${li}</ul></div>`;
  }

  locations.forEach((loc,i)=>{
    const m = L.marker(loc.coords,{icon:iconBadge(loc.icon)}).addTo(map);
    m.bindPopup(popupHtml(loc),{maxWidth:320});
    markers.push(m);
  });

  function showRoute(){
    if(route){ map.removeLayer(route); route=null; }
    const coords = locations.map(l=>l.coords);
    route = L.polyline(coords,{color:getComputedStyle(document.documentElement).getPropertyValue('--green'),weight:4,opacity:.85,dashArray:'10,5',lineCap:'round',lineJoin:'round'}).addTo(map);
    fitAll(); stopAnim();
  }
  function fitAll(){
    const group = new L.featureGroup([...(route?[route]:[]), ...markers]);
    if (group.getLayers().length > 0) { // Έλεγχος για αποφυγή σφάλματος σε κενό group
      map.fitBounds(group.getBounds().pad(0.08));
    } else {
      map.setView([43.4, 20.3], 6); // Επαναφορά αν δεν υπάρχουν σημεία
    }
    stopAnim();
  }
  function stopAnim(){
    if(animTimer){ clearTimeout(animTimer); animTimer=null; }
    animOn=false;
    document.querySelectorAll('.loc').forEach(el=>el.classList.remove('active'));
    const btn=document.getElementById('animBtn'); if(btn) btn.textContent='Animate';
  }
  function toggleAnim(){
    const btn=document.getElementById('animBtn');
    if(animOn){ stopAnim(); return; }
    animOn=true; btn.textContent='Stop';
    let i=0;
    (function step(){
      if(!animOn) return;
      const loc=locations[i];
      map.setView(loc.coords, 11, {animate:true,duration:1.2});
      markers[i].openPopup();
      
      // Highlight sidebar item
      document.querySelectorAll('.loc').forEach(el=>el.classList.remove('active'));
      const active=document.querySelector(`.loc[data-i="${i}"]`); 
      if(active) {
        active.classList.add('active');
        // Scroll sidebar to show active element
        active.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }

      i=(i+1)%locations.length;
      animTimer=setTimeout(step, 3000);
    })();
  }

  // Sidebar bindings
  document.querySelectorAll('.loc').forEach((el)=>{
    el.addEventListener('click', ()=>{
      stopAnim();
      const i=+el.dataset.i;
      map.setView(locations[i].coords, 12, {animate:true});
      markers[i].openPopup();
      document.querySelectorAll('.loc').forEach(e=>e.classList.remove('active'));
      el.classList.add('active');
    });
  });
  
  // Προσθήκη υποστήριξης για Enter key στο sidebar
  document.querySelectorAll('.loc').forEach((el)=>{
    el.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        el.click();
      }
    });
  });


  // Ensure Leaflet knows final size
  window.addEventListener('load', ()=>{
    map.invalidateSize(true);
    showRoute(); // Εμφάνιση της διαδρομής κατά την αρχική φόρτωση
  });
  window.addEventListener('resize', ()=> map.invalidateSize(true));
</script>
</body>
</html>
